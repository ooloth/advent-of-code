#!/usr/bin/env sh

# Python environment
export MYPYPATH="$PWD"
export PYTHONPATH="$PWD"

# Advent of Code options
export AOC_YEAR=2015
export AOC_LANGUAGE=typescript
export AOC_SESSION_FILE="$PWD/.aoc-session-cookie"

# Derived values
case "$AOC_LANGUAGE" in
  python) export AOC_LANGUAGE_EXTENSION=py ;;
  typescript) export AOC_LANGUAGE_EXTENSION=ts ;;
esac

# Debug info
# echo "ðŸŽ„ AOC_YEAR: $AOC_YEAR"
# echo "ðŸŽ„ AOC_LANGUAGE: $AOC_LANGUAGE"
# echo "ðŸŽ„ AOC_LANGUAGE_EXTENSION: $AOC_LANGUAGE_EXTENSION"
# echo "ðŸŽ„ AOC_SESSION_FILE: $AOC_SESSION_FILE"

##############
# VALIDATION #
##############

# AOC_YEAR must be set
if [ -z "$AOC_YEAR" ]; then
  echo "ðŸš¨ AOC_YEAR is not set"
  exit 1
fi

# AOC_YEAR must be 2015-2024
if ! [[ "$AOC_YEAR" =~ ^[0-9]{4}$ ]] || [ "$AOC_YEAR" -lt 2015 ] || [ "$AOC_YEAR" -gt 2024 ]; then
  echo "ðŸš¨ AOC_YEAR must be a year between 2015-2024"
  exit 1
fi

# AOC_LANGUAGE must be set
if [ -z "$AOC_LANGUAGE" ]; then
  echo "ðŸš¨ AOC_LANGUAGE is not set"
  exit 1
fi

# AOC_LANGUAGE must be a supported language
if [ "$AOC_LANGUAGE" != "python" ] && [ "$AOC_LANGUAGE" != "typescript" ]; then
  echo 'ðŸš¨ AOC_LANGUAGE must be "python" or "typescript"'
  exit 1
fi

# AOC_SESSION_FILE must not be empty
if [ -z "$AOC_SESSION_FILE" ]; then
  echo "ðŸš¨ AOC_SESSION_FILE is not set"
  exit 1
fi
